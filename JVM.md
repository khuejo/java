# JVM

## JVM的组成结构？
Java虚拟机（JVM）的组成部分主要包括以下几个部分：
- 类加载器子系统：类加载器负责将Java字节码文件加载到内存中，并在程序运行时动态地链接和初始化类。类加载器包括启动类加载器、扩展类加载器和应用程序类加载器等。
- 运行时数据区：运行时数据区是指JVM用于存储数据的区域。主要包括方法区、堆、虚拟机栈、本地方法栈和程序计数器等。不同的线程拥有独立的虚拟机栈、本地方法栈以及程序计数器，而堆和方法区则是共享的。
- 执行引擎：执行引擎是JVM的核心，负责解释执行Java代码。执行引擎包括解释器和即时编译器（JIT），其中解释器可以直接执行Java字节码，而JIT则将频繁执行的代码编译为本机代码，以提高程序的执行效率。
- 垃圾回收器：垃圾回收器负责对不再使用的对象进行回收和清理，以释放内存空间。JDK中默认提供了多种不同类型的垃圾回收器，如Serial、Parallel、CMS、G1等。
- 本地方法接口（Native Interface）：本地方法接口是JVM与底层操作系统交互的接口。通过本地方法接口，Java程序可以调用本地编写的代码或库，以访问底层资源和执行特定的操作。

总之，JVM是一种用于执行Java程序的虚拟机，主要包括类加载器子系统、运行时数据区、执行引擎、垃圾回收器和本地方法接口等组件。这些组件协同工作，使得Java程序能够在不同的平台上运行，并且具有良好的可移植性和安全性。

## 类是如何被加载的？
Java虚拟机（JVM）在运行Java程序时，需要先将程序中的字节码文件加载到内存中。这个过程称为类加载（Class Loading），它主要包括以下三个步骤：

- 加载（Loading）：加载是指查找并加载类的字节码文件。类加载器（ClassLoader）会根据类的全限定名来搜索对应的字节码文件，并将其读入内存中。
- 链接（Linking）：链接是指将类的字节码文件加入到JVM中，以便于执行。链接又分为三个部分：
  - 验证（Verification）：验证是指对类的字节码文件进行验证，以确保其符合Java虚拟机规范和安全规则。
  - 准备（Preparation）：准备是指给类的静态变量分配内存，并赋予默认值。
  - 解析（Resolution）：解析是指将类或接口中的符号引用转换为直接引用。
- 初始化（Initialization）：初始化是指执行类的构造器方法（即<clinit>方法），为类的静态变量赋初值。

总之，类加载过程是Java程序运行的基础，它将字节码文件加载到内存中，并进行链接和初始化等操作，最终使得程序能够被执行。类加载器、验证器、准备器、解析器和执行引擎等组成了Java虚拟机的类加载子系统，其中每个组件都发挥着重要的作用。

## 双亲委派机制？
JVM默认提供了启动类加载器、扩展类加载器、应用程序类加载器和用户自定义类加载器。其中启动类加载器负责加载核心组件，扩展类加载器负责加载xx组件，xx类加载器负责加载xx组件。双亲委派的意思是下层类加载器在收到加载请求时，会先将请求委派给上层类加载器，如果上层类加载器无法加载，下层类加载器才会开始加载。

## JVM的内存结构？
JVM的内存结构也就是运行时数据区，可细分为虚拟机栈、本地方法栈、程序计数器、堆及方法区五部分。其中虚拟机栈是非本地方法的内存的模型，具体可分为xx。本地方法栈是本地方法的内存模型，其结构与虚拟机栈一致。程序计数器存储的是下一条指令的地址。堆存储的对象及数组，是最大的一块区域。方法区存储的是常量、静态变量及代码信息。这五部分中程序计数器、虚拟机栈和本地方法栈是随线程生而生，灭而灭的，除了程序计数器，其他四部分都会因为无足够内存抛出异常。

## JVM如何GC？
JVM第一步是要识别可以GC的对象，这里主要有两种算法：①引用计数法；②
